<!DOCTYPE html>
<html>
<head>
<audio id = "beep01">
  <source src="sound/beep01.mp3" type="audio/mpeg">
</audio>
<audio id = "beep02">
  <source src="sound/beep02.mp3" type="audio/mpeg">
</audio>
<audio id = "beep03">
  <source src="sound/beep03.mp3" type="audio/mpeg">
</audio>
<audio id = "flip">
  <source src="sound/flip.mp3" type="audio/mpeg">
</audio>
<script type="text/javascript" src="quill/quill.js"></script>
<script>

function inicio(){
  // Criando editor rich text e vetor de cores
  editor = new Quill('#editor');
  cores = ['rgb(255,255,255)','rgb(0,255,255)','rgb(0,150,0)','rgb(255,0,0)'];
  coresCont = 0;

  // Vetor para salvar combinacao
  combination = ["",""];
  indice = 0;

  // Vetor para salvar posicoes do teclado
  teclado = [false,false,false,false,false,false,false,false];

  // Definindo tamanho do canvas
  c = document.getElementById("myCanvas");
  c.width = window.screen.width;
  c.height= window.screen.height;
  ctx = c.getContext("2d");

  // Definindo proporção e tamanho de fonte inicial
  var font_inicial = 30;
  var font_side = font_inicial/1.4142;
  var ratio_width = c.width/font_side;
  var ratio_height = c.height/font_side;
  var ratio = Math.sqrt((ratio_width*ratio_width) + (ratio_height*ratio_height));
  ratio = ratio/69.23;
  size_font_big = font_inicial*ratio;
  var screen_ratio = ((c.width/c.height)*0.5)/1.778;
  size_font_small = size_font_big*screen_ratio;


  // hu3

  posicao = [];
  /* CE */ posicao[0] = { width1A:c.width*0.01,width2A:c.width*0.01,width3A:9999,width1B:c.width*0.01+size_font_big,width2B:c.width*0.01+size_font_big,width3B:9999,width1C:c.width*0.387,width2C:c.width*0.387,width3C:9999,height1A:size_font_big ,height2A:size_font_big*2 ,height3A:9999,height1B:size_font_big*1.7, height2B:size_font_big*1.7+size_font_small,height3B:9999,height1C:c.height*0.37+size_font_small, height2C:c.height*0.37+size_font_small*2,height3C:9999,text1A:"A B", text1B:"C", text1C:"",text2A:"Y Z", text2B:"0",text2C:"",highlightW:0, highlightH:0};
  /*  E */ posicao[1] = { width1A:c.width*0.01,width2A:c.width*0.01,width3A:c.width*0.01, width1B:c.width*0.013+size_font_big,width2B:c.width*0.013+size_font_big,width3B:c.width*0.013+size_font_big, width1C:c.width*0.387,width2C:c.width*0.387,width3C:c.width*0.387, height1A:c.height*0.475 ,height2A:c.height*0.475+size_font_big ,height3A:c.height*0.475+size_font_big*2, height1B:c.height*0.475, height2B:c.height*0.475+size_font_big,height3B:c.height*0.475+size_font_big*2, height1C:c.height*0.485, height2C:c.height*0.485+size_font_small,height3C:c.height*0.485+size_font_small*2 ,text1A:'S', text1B:'T', text1C:'U',text2A:'V', text2B:'W',text2C:'X',highlightW:0, highlightH:c.height/2};
  /* BE */ posicao[2] = { width1A:c.width*0.01,width2A:c.width*0.01,width3A:9999, width1B:c.width*0.01+size_font_big,width2B:c.width*0.01+size_font_big,width3B:9999, width1C:c.width*0.387,width2C:c.width*0.387,width3C:9999, height1A:c.height*0.95,height2A:c.height*0.95+size_font_big ,height3A:9999, height1B:c.height*0.95-size_font_small, height2B:c.height*0.95,height3B:9999, height1C:c.height*0.60, height2C:c.height*0.60+size_font_small,height3C:9999 ,text1A:'P', text1B:'Q R', text1C:'',text2A:'P', text2B:'Q R',text2C:'',highlightW:0, highlightH:c.height};
  /* CD */ posicao[3] = { width1A:c.width*0.95,width2A:c.width*0.95+size_font_big,width3A:9999, width1B:c.width*0.95,width2B:c.width*0.95+size_font_big,width3B:9999, width1C:c.width*0.59,width2C:c.width*0.59+size_font_small,width3C:9999, height1A:size_font_big ,height2A:size_font_big*2 ,height3A:9999, height1B:size_font_big*1.7, height2B:size_font_big*2.2,height3B:9999, height1C:c.height*0.37+size_font_small, height2C:c.height*0.37+size_font_small*2,height3C:9999 ,text1A:'G H', text1B:'  I', text1C:'',text2A:'    4 5', text2B:'6',text2C:'',highlightW:c.width, highlightH:0};
  /* BD */ posicao[4] = { width1A:c.width*0.95+size_font_big ,width2A:c.width*0.95, width3A:0,width1B:0,width2B:0,width3B:0,width1C:c.width*0.59+size_font_small,width2C:c.width*0.59,width3C:0, height1A:c.height*0.95, height2A:c.height*0.95+size_font_big, height3A:0,height1B:0,height2B:0,height3B:0,height1C:c.height*0.60,height2C:0,height3C:c.height*0.60+size_font_small, text1A:"M", text2A:"O N", text3A:'',text1B:'', text2B:'', text3B:'', highlightW:c.width, highlightH:c.height};
  /*  D */ posicao[5] = { flag:'V',width1A:c.width*0.95+size_font_big ,width1B:c.width*0.95+size_font_big, width1C:c.width*0.95+size_font_big,width3A:c.width*0.59+size_font_small,width3B:c.width*0.59+size_font_small,width3C:c.width*0.59+size_font_small,width2A:c.width*0.937+size_font_big,width2B:c.width*0.937+size_font_big,width2C:c.width*0.937+size_font_big, height1A:c.height*0.475, height2A:c.height*0.475+size_font_big, height3A:c.height*0.475+size_font_big*2,height1C:c.height*0.485,height2C:c.height*0.485+size_font_small,height3C:c.height*0.485+size_font_small*2,height1B:c.height*0.475,height2B:c.height*0.475+size_font_big,height3B:c.height*0.475+size_font_big*2, text1A:" J", text2A:" K", text3A:" L",text1B:"7", text2B:"8", text3B:"9", highlightW:c.width, highlightH:c.height/2};
  /*  C */ posicao[6] = { width1A:c.width*0.50-size_font_big*1.3,width2A:0, width3A:0,width1B:c.width*0.50-size_font_small*1.3,width2B:0,width3B:0,width1C:c.width*0.50-size_font_small*1.3,width2C:0,width3C:0, height1A:size_font_big, height2A:0, height3A:0,height1B:size_font_big*1.5,height2B:0,height3B:0,height1C:c.height*0.37+size_font_small,height2C:0,height3C:0, text1A:"D E F", text2A:'', text3A:'',text1B:"1 2 3", text2B:'', text3B:'', highlightW:c.width/2, highlightH:0};
  /*  B */ posicao[7] = { flag:'H',width1A:c.width*0.50-size_font_big*6.3,width2A:0, width3A:0,width1B:0,width2B:0,width3B:0,width1C:c.width*0.50-size_font_small*6.3,width2C:0,width3C:0, height1A:c.height*0.95+size_font_big, height2A:0, height3A:0,height1B:0,height2B:0,height3B:0,height1C:c.height*0.60+size_font_small,height2C:0,height3C:0, text1A:"APAGAR ESPACO PONTO", text1B:'', text1C:'',text2A:'', text2B:'', text2C:'', highlightW:c.width/2, highlightH:c.height};

  // Desenhando teclado inicial
  canvasDraw();
}

function canvasDrawLine()
{
  ctx.fillStyle = "white";
  ctx.strokeStyle = "white";
  ctx.lineWidth = 5;

  ctx.beginPath();
  ctx.moveTo(c.width*0.38,c.height*0.38);
  ctx.lineTo(size_font_big*2,size_font_big*2);
  ctx.stroke();

  ctx.beginPath();
  ctx.moveTo(c.width*0.38,c.height*0.38);
  ctx.lineTo(size_font_big*2,size_font_big*2);
  ctx.stroke();//< /\

  ctx.beginPath();
  ctx.moveTo(c.width*0.38,c.height*0.5);
  ctx.lineTo(size_font_big*2.23,c.height*0.5);
  ctx.stroke();//<

  ctx.beginPath();
  ctx.moveTo(c.width*0.38,c.height*0.62);
  ctx.lineTo(size_font_big*2,c.height-size_font_big*2);
  ctx.stroke();//< \/

  ctx.beginPath();
  ctx.moveTo(c.width*0.5,c.height*0.63);
  ctx.lineTo(c.width*0.5,c.height-size_font_big*2);
  ctx.stroke();//\/

  ctx.beginPath();
  ctx.moveTo(c.width*0.62,c.height*0.62);
  ctx.lineTo(c.width-size_font_big*2,c.height-size_font_big*2);
  ctx.stroke();//> \/

  ctx.beginPath();
  ctx.moveTo(c.width*0.62,c.height*0.5);
  ctx.lineTo(c.width-size_font_big*2,c.height*0.5);
  ctx.stroke();//>

  ctx.beginPath();
  ctx.moveTo(c.width*0.62,c.height*0.38);
  ctx.lineTo(c.width-size_font_big*2,size_font_big*2);
  ctx.stroke();//> /\

  ctx.beginPath();
  ctx.moveTo(c.width*0.5,c.height*0.36);
  ctx.lineTo(c.width*0.5,size_font_big*2);
  ctx.stroke();// /\
}

function canvasDraw()
{
  // Desenhando linhas
  canvasDrawLine();
  // Desenhando letras em cada ponto da tela
  canvasDrawTeclado(0,0);
  canvasDrawTeclado(0,1);
  canvasDrawTeclado(0,2);
  canvasDrawTeclado(0,3);
  canvasDrawTeclado(0,4);
  canvasDrawTeclado(0,5);
  canvasDrawTeclado(0,6);
  canvasDrawTeclado(0,7);

}

function keyboardTrans(pos) //funcao que retira ou insere o highlight num conjunto de letras
{
   switch(pos)
		  {
			case "CE":
        teclado[0]=!teclado[0];
				break;
			case "E":
        teclado[1]=!teclado[1];
				break;
			case "BE":
        teclado[2]=!teclado[2];
				break;
			case "CD":
        teclado[3]=!teclado[3];
				break;
			case "D":
        teclado[4]=!teclado[4];
				break;
			case "BD":
        teclado[5]=!teclado[5];
				break;
			case "C":
        teclado[6]=!teclado[6];
				break;
			case "B":
        teclado[7]=!teclado[7];
				break;
		  }
      // Limpa tela
      Switch(pos,0);
      document.getElementById('flip').play();
}

function Switch(pos,flag) //funcao que retira ou insere o highlight num conjunto de letras
{
   switch(pos)
      {
      case "C":
        highlight(width/2,0,flag);
        break;
      case "CD":
        highlight(width,0,flag);
        break;
      case "D":
        highlight(width,height/2,flag);
        break;
      case "BD":
        highlight(width,height,flag);
        break;
      case "B":
        highlight(width/2,height,flag);
        break;
      case "BE":
        highlight(0,height,flag);
        break;
      case "E":
        highlight(0,height/2,flag);
        break;
      case "CE":
        highlight(0,0,flag);
        break;
      }
      canvasDraw();
}

function highlight(x,y,limpar)
{
  // Limpa tela
  ctx.clearRect ( 0 , 0 , c.width, c.height );
  if (limpar)
  {
    ctx.beginPath()
	  ctx.arc(x,y,width*0.1,0,2*Math.PI);
	  ctx.fillStyle = "black";
	  ctx.fill();
  }
  else
  {
    var grd = ctx.createRadialGradient(x,y,c.width*0.001,x,y,c.width*0.5);
    grd.addColorStop(0,"black");
    grd.addColorStop(1,"white");
    ctx.beginPath();
    ctx.arc(x,y,c.width*0.1,0,2*Math.PI);
    ctx.fillStyle = grd;
    ctx.fill();
  }
}

function canvasDrawTeclado(controle,pos)
{
  if(!controle)
  {
    var A1 = posicao[pos].text1A;
    var B1 = posicao[pos].text1B;
    var C1 = posicao[pos].text1C;
    var A2 = posicao[pos].text2A;
    var B2 = posicao[pos].text2B;
    var C2 = posicao[pos].text2C;

    if(teclado[pos])
    {
      A2 = posicao[pos].text1A;
      B2 = posicao[pos].text1B;
      C2 = posicao[pos].text1C;
      A1 = posicao[pos].text2A;
      B1 = posicao[pos].text2B;
      C1 = posicao[pos].text2C;
    }
    //Teclado Primario
    ctx.font = size_font_big+"px Arial";
    ctx.fillText(A1,posicao[pos].width1A,posicao[pos].height1A);
    ctx.fillText(B1,posicao[pos].width2A,posicao[pos].height2A);
    ctx.fillText(C1,posicao[pos].width3A,posicao[pos].height3A);
    //Teclado Secundario
    ctx.font = size_font_small+"px Arial";
    ctx.fillText(A2,posicao[pos].width1B,posicao[pos].height1B);
    ctx.fillText(B2,posicao[pos].width2B,posicao[pos].height2B);
    ctx.fillText(C2,posicao[pos].width3B,posicao[pos].height3B);
    // MINIATURA
    ctx.fillText(A1,posicao[pos].width1C,posicao[pos].height1C);
    ctx.fillText(B1,posicao[pos].width2C,posicao[pos].height2C);
    ctx.fillText(C1,posicao[pos].width3C,posicao[pos].height3C);

  }
}
function Coordenadas(objeto) {
    x = objeto.clientX;
    y = objeto.clientY;


    width = window.screen.width;
    height = window.screen.height;
    var width_part = (width / 4);
    var height_part = (height / 3);
    var pos = "N";
    var comb = "";
    var aux = 0;
    var aux2 = 1; // time event


    if(x == 0) {
        if(y <= height_part ) {
          pos = "CE"
        } else if(y >= (height_part * 2)) {
          pos = "BE"
        } else {
          pos = "E"
        }
    }

    if(x == (width-1) ){
        if(y <= height_part ) {
          pos = "CD"
        } else if(y >= (height_part * 2)) {
          pos = "BD"
        } else {
          pos = "D"
        }
    }


    if(y == 0) {
       if(x <= width_part) {
          pos = "CE"
       } else if(x >= (width_part * 3)) {
          pos = "CD"
       } else {
          pos = "C"
       }
    }


    if(y >= (height-5)) {
      if(x <= width_part) {
          pos = "BE"
      } else if(x >= (width_part * 3)) {
          pos = "BD"
      } else {
          pos = "B"
      }
    }


    if(pos != "N"){
       if(indice == 0){
          combination[indice] = pos;
		      Switch(pos,0);
          indice++;
          timerId = setInterval
          (function(){keyboardTrans(pos);}, 3000);
          document.getElementById('beep01').play();
       }
       else if(combination[(indice - 1)] != pos){
          combination[indice] = pos;
          indice++;
          document.getElementById('beep02').play();
          clearInterval(timerId);
          aux2 = 0;
       }
    }

    if(x >= (width*0.4)) {
       if(x <= (width*0.6)) {
           if(y <= height*0.6){
                if(y >= height*0.4)
                {
                    while(indice > aux)
                {
              comb = comb + combination[aux];
              aux++
              }
              if(aux2)
                clearInterval(timerId);
              Letra(comb);
			        Switch(combination[0],1);
              indice = 0;
              pos = "N";
              // Teclados(pos);
                }
           }
       }
    }

}

function Letra(pos)
{
    var length = editor.getLength();
    if(pos != "")
      document.getElementById('beep03').play()

    if(pos == "CE")
		if (!teclado[0])
			editor.insertText(length-1, 'a',{'color': cores[coresCont],'size':'30px'});
		else
			editor.insertText(length-1, 'y',{'color': cores[coresCont],'size':'30px'});
    if(pos == "CEC")
		if (!teclado[0])
			editor.insertText(length-1, 'b',{'color': cores[coresCont],'size':'30px'});
		else
			editor.insertText(length-1, 'z',{'color': cores[coresCont],'size':'30px'});
    if(pos == "CEE")
		if (!teclado[0])
			editor.insertText(length-1, 'c',{'color': cores[coresCont],'size':'30px'});
		else
			editor.insertText(length-1, '0',{'color': cores[coresCont],'size':'30px'});

    if(pos == "ECE")
		if (!teclado[1])
			editor.insertText(length-1, 's',{'color': cores[coresCont],'size':'30px'});
		else
			editor.insertText(length-1, 'v',{'color': cores[coresCont],'size':'30px'});
    if(pos == "E")
		if (!teclado[1])
			editor.insertText(length-1, 't',{'color': cores[coresCont],'size':'30px'});
		else
			editor.insertText(length-1, 'w',{'color': cores[coresCont],'size':'30px'});
    if(pos == "EBE")
		if (!teclado[1])
			editor.insertText(length-1, 'u',{'color': cores[coresCont],'size':'30px'});
		else
			editor.insertText(length-1, 'x',{'color': cores[coresCont],'size':'30px'});

    if(pos == "BEE")
		//if (!teclado[2])
			editor.insertText(length-1, 'p',{'color': cores[coresCont],'size':'30px'});
		//else
			//editor.insertText(length-1, '4',{'color': cores[coresCont],'size':'30px'});
    if(pos == "BE")
		//if (!teclado[2])
			editor.insertText(length-1, 'q',{'color': cores[coresCont],'size':'30px'});
		//else
			//editor.insertText(length-1, '5',{'color': cores[coresCont],'size':'30px'});
    if(pos == "BEB")
		//if(!teclado[2])
			editor.insertText(length-1, 'r',{'color': cores[coresCont],'size':'30px'});
		//else
			//editor.insertText(length-1, '6',{'color': cores[coresCont],'size':'30px'});

    if(pos == "CDC")
		if(!teclado[3])
			editor.insertText(length-1, 'g',{'color': cores[coresCont],'size':'30px'});
		else
			editor.insertText(length-1, '4',{'color': cores[coresCont],'size':'30px'});
    if(pos == "CD")
		if (!teclado[3])
			editor.insertText(length-1, 'h',{'color': cores[coresCont],'size':'30px'});
		else
			editor.insertText(length-1, '5',{'color': cores[coresCont],'size':'30px'});
    if(pos == "CDD")
		if (!teclado[3])
			editor.insertText(length-1, 'i',{'color': cores[coresCont],'size':'30px'});
		else
			editor.insertText(length-1, '6',{'color': cores[coresCont],'size':'30px'});

    if(pos == "DCD")
		if (!teclado[4])
			editor.insertText(length-1, 'j',{'color': cores[coresCont],'size':'30px'});
		else
			editor.insertText(length-1, '7',{'color': cores[coresCont],'size':'30px'});
    if(pos == "D")
       if (!teclado[4])
			editor.insertText(length-1, 'k',{'color': cores[coresCont],'size':'30px'});
		else
			editor.insertText(length-1, '8',{'color': cores[coresCont],'size':'30px'});
    if(pos == "DBD")
       if (!teclado[4])
			editor.insertText(length-1, 'l',{'color': cores[coresCont],'size':'30px'});
		else
			editor.insertText(length-1, '9',{'color': cores[coresCont],'size':'30px'});


    if(pos == "BDD")
       editor.insertText(length-1, 'r',{'color': cores[coresCont],'size':'30px'});
    if(pos == "BDB")
       editor.insertText(length-1, 's',{'color': cores[coresCont],'size':'30px'});
    if(pos == "BD")
       editor.insertText(length-1, 't',{'color': cores[coresCont],'size':'30px'});


    if(pos == "CCE")
		if (!teclado[6])
			editor.insertText(length-1, 'd',{'color': cores[coresCont],'size':'30px'});
		else
			editor.insertText(length-1, '1',{'color': cores[coresCont],'size':'30px'});
    if(pos == "C")
		if (!teclado[6])
			editor.insertText(length-1, 'e',{'color': cores[coresCont],'size':'30px'});
	    else
			editor.insertText(length-1, '2',{'color': cores[coresCont],'size':'30px'});
    if(pos == "CCD")
		if (!teclado[6])
			editor.insertText(length-1, 'f',{'color': cores[coresCont],'size':'30px'});
		else
			editor.insertText(length-1, '3',{'color': cores[coresCont],'size':'30px'});

	if(pos == "B")
       editor.insertText(length-1,' ',{'color': cores[coresCont],'size':'30px'});
    if(pos == "BBE")
    {
       var lastChar = editor.getText(length-2,length-1);
       if(lastChar == '.')
       	   if(coresCont == 0)
               coresCont = 3;
           else
               coresCont--;
       editor.deleteText(length-2,length);
    }
    if(pos == "BBD")
    {
       editor.insertText(length-1,'.',{'color': cores[coresCont],'size':'30px'});
       if(coresCont == 3)
	  coresCont = 0;
       else
	  coresCont++;
    }
    objeto = document.getElementById('editor');
    objeto.scrollTop = objeto.scrollHeight;
}

</script>
</head>
<body  style="margin:0px" onLoad="inicio()">
<style>
body {position:fixed;width:100%; height:100%; overflow:hidden, margin:0}
html {width:100%; height:100%; overflow:hidden}
</style>

<div id="coordiv" style="width:100%;height:100%;border:1px solid;z-index:1" onmousemove="Coordenadas(event)">
<canvas id="myCanvas" style="border:1px; background-color:black"></canvas>
<div id="editor" style="position: absolute; left:40%;top:40%; width:20%; height: 20%;border:2px solid white"></div>
</div>
</body>
</html>
