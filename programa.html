<!DOCTYPE html>
<!--  Fev,2015 UFSCar
      v0.18
      Guilherme M. A. Ramos
      Victor Otavio Nogueira Sales
                                    -->
<html>
<head>
  <title>IC v0.18</title>
  <audio id = "beep01">
    <source src="data/sound/beep01.mp3" type="audio/mpeg">
  </audio>
  <audio id = "beep02">
    <source src="data/sound/beep02.mp3" type="audio/mpeg">
  </audio>
  <audio id = "beep03">
    <source src="data/sound/beep03.mp3" type="audio/mpeg">
  </audio>
  <audio id = "flip">
    <source src="data/sound/flip.mp3" type="audio/mpeg">
  </audio>
  <audio id = "lock">
    <source src="data/sound/lock.mp3" type="audio/mpeg">
  </audio>
<script type="text/javascript" src="src/quill/quill.js"></script>
<script type="text/javascript" src="src/spin/spin.js"></script>
<script>
function inicio(){
  // Criando editor rich text e vetor de cores
  editor = new Quill('#editor');
  cores = ['rgb(255,255,255)','rgb(255,255,0)'];
  coresCont = 0;

  cursorVisivel = 1;
  cursor();

// Vetor de cookies
  CookiesDeHoje = ""; 

  // Cookies
  texto = "";
  indiceCookie = 1;
  var d = new Date();
  var n = new Date();
  var o = new Date(n.getTime()-24*60*60*1000); //ontem
  d.setTime(d.getTime() + (30*24*60*60*1000));//30 dias de validade de um cookie

  var nomeCookie = o.toString().substring(4,15); //pegando cookies de ontem
  nomeCookie = trim(nomeCookie);
  while (getCookie(nomeCookie+"_"+indiceCookie) != "")
  {
     CookiesDeHoje += "*"+getCookie(nomeCookie+"_"+indiceCookie)+"\n";
     indiceCookie++;
  }


  indiceCookie = 1;
  var nomeCookie = n.toString().substring(4,15); //pegando cookies de hoje
  nomeCookie = trim(nomeCookie);
  while (getCookie(nomeCookie+"_"+indiceCookie) != "")
  {
     CookiesDeHoje += "*"+getCookie(nomeCookie+"_"+indiceCookie)+"\n";
	   indiceCookie++;
  }
  


  timerAutoSave = setInterval(function(){document.cookie = nomeCookie+"_"+indiceCookie+"="+texto+"; expires="+d.toUTCString();}, 5000);
  //timerTesteAutoSave = setInterval(function(){alert(getAllCookies("Feb"));}, 11000);//mostra todas as informações salvas nos 30 dias do mes atual

  // Vetor para salvar combinacao
  combination = ["",""];
  indice = 0;
  timerAux = 0;

  // Variavel shift
  shiftaux = false;

  // Definindo tamanho do canvas
  c = document.getElementById("myCanvas");
  c.width = window.screen.width;
  c.height= window.screen.height;
  ctx = c.getContext("2d");

  // Definindo proporção e tamanho de fonte inicial
  var font_inicial = 30;
  var font_side = font_inicial/1.4142;
  var ratio_width = c.width/font_side;
  var ratio_height = c.height/font_side;
  var ratio = Math.sqrt((ratio_width*ratio_width) + (ratio_height*ratio_height));
  var ratio = ratio/69.23;
  size_font_big = font_inicial*ratio;
  var screen_ratio = ((c.width/c.height)*0.5)/1.778;
  size_font_small = size_font_big*screen_ratio;


  // Criando vetor com todos os dados usados para desenhar o teclado + o highlight
  vetorDados = [];
  /* A */ vetorDados[0] = { font1:"Arial",font2:"Arial",teclado:false,
                             width1A:c.width*0.02,width2A:c.width*0.01+size_font_big,width3A:c.width*0.01,
                             width1C:c.width*0.385-size_font_small,width2C:c.width*0.385,width3C:c.width*0.385-size_font_small,
                             width1D:c.width*0.385,width2D:c.width*0.385+size_font_small,width3D:c.width*0.385,
                             height1A:size_font_big*2 ,height2A:size_font_big ,height3A:size_font_big*2,
                             height1C:c.height*0.37, height2C:c.height*0.37,height3C:c.height*0.37+size_font_small,
                             height1D:c.height*0.37+size_font_small, height2D:c.height*0.37+size_font_small,height3D:c.height*0.37+size_font_small*2,
                             text1A:"A", text1B:"B", text1C:"C",text2A:"0", text2B:"Z",text2C:"Y",highlightW:0, highlightH:0
                            };
  /*  E */ vetorDados[1] = { font1:"Arial",font2:"Arial",teclado:false,
                             width1A:c.width*0.02,width2A:c.width*0.01,width3A:c.width*0.01,
                             width1C:c.width*0.368,width2C:c.width*0.368,width3C:c.width*0.368,
                             width1D:c.width*0.385,width2D:c.width*0.385,width3D:c.width*0.385,
                             height1A:c.height*0.52 ,height2A:c.height*0.5+size_font_big ,height3A:c.height*0.5+size_font_big*2,
                             height1C:c.height*0.485, height2C:c.height*0.485+size_font_small,height3C:c.height*0.485+size_font_small*2 ,
                             height1D:c.height*0.485, height2D:c.height*0.485+size_font_small,height3D:c.height*0.485+size_font_small*2 ,
                             text1A:'T', text1B:'U', text1C:'V',text2A:'K', text2B:'W',text2C:'X',highlightW:0, highlightH:c.height/2
                           };
  /* H */ vetorDados[2] = { teclado:false,width1A:c.width*0.01,width2A:c.width*0.01,width3A:9999, width1B:c.width*0.01+size_font_big,width2B:c.width*0.01+size_font_big,width3B:9999, width1C:c.width*0.387,width2C:c.width*0.387,width3C:9999, height1A:c.height*0.95,height2A:c.height*0.95+size_font_big ,height3A:9999, height1B:c.height*0.95-size_font_small, height2B:c.height*0.95,height3B:9999, height1C:c.height*0.60, height2C:c.height*0.60+size_font_small,height3C:9999 ,text1A:'Q', text1B:'S R', text1C:'',text2A:'', text2B:'',text2C:'',highlightW:0, highlightH:c.height};
  /* F */ vetorDados[3] = { font1:"Arial",font2:"Arial",teclado:false,
                             width1A:c.width*0.965,width2A:c.width*0.95+size_font_big,width3A:c.width*0.95+size_font_big,
                             width1C:c.width*0.59+size_font_small,width2C:c.width*0.59+size_font_small*2,width3C:c.width*0.59+size_font_small*2,
                             width1D:c.width*0.59,width2D:c.width*0.59+size_font_small,width3D:c.width*0.59+size_font_small,
                             height1A:size_font_big*2 ,height2A:size_font_big ,height3A:size_font_big*2,
                             height1C:c.height*0.37, height2C:c.height*0.37,height3C:c.height*0.37+size_font_small ,
                             height1D:c.height*0.37+size_font_small, height2D:c.height*0.37+size_font_small,height3D:c.height*0.37+size_font_small*2 ,
                             text1A:' G', text1B:' I', text1C:'H',text2A:'4', text2B:'5',text2C:'6',highlightW:c.width, highlightH:0
                           };
  /* G */ vetorDados[4] = { font1:"Arial",font2:"Arial",teclado:false,width1A:c.width*0.95+size_font_big ,width2A:c.width*0.95, width3A:0,width1C:c.width*0.59+size_font_small,width2C:c.width*0.59,width3C:0, height1A:c.height*0.95, height2A:c.height*0.95+size_font_big, height3A:0,height1C:c.height*0.60,height2C:c.height*0.60+size_font_small,height3C:c.height*0.60+size_font_small, text1A:"N", text1B:"P O", text1C:'',text2A:'', text2B:'', text2C:'', highlightW:c.width, highlightH:c.height};
  /*  D */ vetorDados[5] = { font1:"Arial",font2:"Arial",teclado:false,
                             width1A:c.width*0.94+size_font_big ,width2A:c.width*0.94+size_font_big, width3A:c.width*0.94+size_font_big,
                             width1C:c.width*0.59+size_font_small*2,width2C:c.width*0.59+size_font_small*2,width3C:c.width*0.59+size_font_small*2,
                             width1D:c.width*0.59+size_font_small,width2D:c.width*0.59+size_font_small,width3D:c.width*0.59+size_font_small,
                             height1A:c.height*0.51,height2A:c.height*0.475+size_font_big,height3A:c.height*0.475+size_font_big*2,
                             height1C:c.height*0.485,height2C:c.height*0.485+size_font_small,height3C:c.height*0.485+size_font_small*2,
                             height1D:c.height*0.485,height2D:c.height*0.485+size_font_small,height3D:c.height*0.485+size_font_small*2,
                             text1A:" J", text1B:" L", text1C:" M",text2A:" 7", text2B:" 8", text2C:" 9", highlightW:c.width, highlightH:c.height/2
                           };
  /*  C */ vetorDados[6] = { font1:"Arial",font2:"Arial",teclado:false,
                             width1A:c.width*0.49,width2A:c.width*0.50-size_font_big*0.3, width3A:c.width*0.50+size_font_big*0.7,
                             width1C:c.width*0.50-size_font_small*1.3,width2C:c.width*0.50-size_font_small*0.3,width3C:c.width*0.50+size_font_small*0.7,
                             width1D:c.width*0.50-size_font_small*1.3,width2D:c.width*0.50-size_font_small*0.3,width3D:c.width*0.50+size_font_small*0.7,
                             height1A:size_font_big*2, height2A:size_font_big, height3A:size_font_big,
                             height1C:c.height*0.37,height2C:c.height*0.37,height3C:c.height*0.37,
                             height1D:c.height*0.37+size_font_small,height2D:c.height*0.37+size_font_small,height3D:c.height*0.37+size_font_small,
                             text1A:"D", text1B:'E', text1C:'F',text2A:"1", text2B:'2', text2C:'3', highlightW:c.width/2, highlightH:0
                           };
  /*  B */ vetorDados[7] = { font1:"betsy2",font2:"betsy2",teclado:false,width1A:c.width*0.49,width2A:0, width3A:0,width1C:c.width*0.50-size_font_small*4,width2C:0,width3C:0, height1A:c.height*0.95, height2A:0, height3A:0,height1C:c.height*0.63+size_font_small,height2C:0,height3C:0, text1A:"V D A", text1B:'', text1C:'',text2A:'', text2B:'', text2C:'', highlightW:c.width/2, highlightH:c.height};
  posicao = { A:vetorDados[0] , E:vetorDados[1] , H:vetorDados[2],F:vetorDados[3],G:vetorDados[4],D:vetorDados[5],C:vetorDados[6],B:vetorDados[7]};

  

  // Carregando
  setTimeout(function(){ocioso(2);},3000);

  // Inicializando fontes externas
  ctx.font = size_font_big+"px sign"
  ctx.fillText("^",posicao["C"].width1A,posicao["C"].height1A);
  ctx.font = size_font_big+"px keys"
  ctx.fillText("^",posicao["C"].width1A,posicao["C"].height1A);

  
  editor.insertText(editor.getLength()-1,CookiesDeHoje,{'color': cores[coresCont],'size':'30px'});

  canvasDraw();

  // Chama a tela de splash
  ocioso(1);
}
function logWindow()
{
  var janela = document.getElementById("logs");
  if(janela.style.visibility == 'hidden')
    janela.style.visibility="visible";
  else
    janela.style.visibility="hidden";
}
function ocioso(controle)
{
    ctx.fillStyle = 'white';
    // Limpa tela
    ctx.clearRect ( 0 , 0 , c.width, c.height );
    // Calculando posicao do spinner
    var topRatio = ((c.width/2)+64*3)*(100/c.width)+'%';
    // Escondendo o editor o log e o botao
    document.getElementById("editor").style.visibility="hidden";
    // Recebendo imagem e mostrando na tela
    var img = new Image();
    // Caso a tela tenha sido bloqueada
    if(controle == 0)
    {
      // Carregando imagens
      img.src = "./data/img/locked.png";
      img.onload = function(){ctx.drawImage(img,c.width/2-64,c.height/2-64);}
      //document.getElementById("logsButton").style.visibility="visible";
	  document.getElementById("editor").style.visibility="visible";
	  document.getElementById("editor").style.border="0px";
      // Declarando aplicao como travado
      status = 1;
	  // Timer para apagar texto
	  apagarEditor = setTimeout(function(){document.getElementById("editor").style.visibility="hidden";},60000);
    }
    // Caso o programa esteja sendo inicializado
    if(controle == 1)
    {
      // Carregando imagens
      img.src = "./data/img/splash.png";
      img.onload = function(){ctx.drawImage(img,c.width/2-64,c.height/2-64);}
      // Alinhando e escrevendo texto
      ctx.textAlign="center";
      ctx.font = size_font_big+"px Arial";
      ctx.fillText("Carregando",c.width/2,((c.height/2)-64*2));
      // Definindo velocidade do spinner
      spinner_speed = 3;
      // Definindo status como inicializando
      status = 2;
    }
    // Desbloqueando a tela
    if(controle == 2)
    {
	  if(status == 1)
	     clearTimeout(apagarEditor);
      // Definindo status como livre
      status = 0;
      // Limpando tela
      highlight(0,0,1);
      // Gerando borda do editor
	  document.getElementById("editor").style.visibility="visible";
	  document.getElementById("editor").style.border="2px solid white";
    }
    //  Definindo suas propriedades
    var opts =
    {
      lines: 7, // Numero de linhas no spinner
      length: 5, // Tamanho de cada linha
      width: 5, // Espessura de cada linha
      radius: 10, // Raio da circunferencia interior
      corners: 0, // Formato dos cantos 0 = quadrado 1 = circular  (0..1)
      rotate: 0, // offset de rotacao
      direction: 1, // 1: sentido horario, -1: sentido anti-horario
      color: '#fff', // #rgb ou #rrggbb ou vetor de cores
      speed: spinner_speed, // Rotacoes por segundo
      trail: 30, // % de trilha deixada nas posicoes anteriores
      shadow: true, // Sombra
      hwaccel: true, // Usar hardware acceleration
      className: 'spinner', // Classe CSS do spinner , se existir
      zIndex: 2e9, // O z-index (defaults to 2000000000)
      top: topRatio, // Posicao y -Relativo ao div pai-
      left: '50%' // Posicao x -Relativo ao div pai-
    };
    if(controle == 1)
    {
      // Desenhando spinner no div
      target = document.getElementById("spinnerDiv");
      spinner = new Spinner(opts).spin(target);
    }
    else
      spinner.stop(target);
}
function getCookie(cname) {
    var name = cname + "=";
    var ca = document.cookie.split(';');
    for(var i=0; i<ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1);
        if (c.indexOf(name) == 0) return c.substring(name.length,c.length);
    }
    return "";
}

function trim(str){
    r = "";
    for(i = 0; i < str.length; i++){
      if(str.charAt(i) != ' ')
        r += str.charAt(i);
   }
  return r;
}


function getAllCookies(dia,month,year)
{
  var valor="";
	var auxiliar = 1;
	while (getCookie(month+dia+year+"_"+auxiliar) != "")
	{
    valor = valor+" - "+getCookie(month+dia+year+"_"+auxiliar);
	  auxiliar++;
	}
  if (valor != "")
  {
    CookiesDeHoje = valor;
  }
}

function downloadCookie()
{
  var dia = document.getElementById("dia").selectedIndex;
  var mes = document.getElementById("mes").selectedIndex;
  var ano = document.getElementById("ano").selectedIndex;
  var textoParaDownload = "";

  if (ano == "0")//ano varia
  {
    for (var i = 2014; i < 2017; i++)
    {
      if (mes =="0")//mes varia
      {
        for (var j = 1; j < 13; j++)
        {
          if (dia == "0")//dia varia
          {
            for (var k = 1; k < 32; k++)
            {
               getAllCookies(k,j,i);
            }
          }
          else//dia nao varia
          {
            getAllCookies(dia,j,i);
          }
        }
      }
      else //mes nao varia
      {
        if (dia == "0")//dia varia
          {
            for (var k = 1; k < 32; k++)
            {
               getAllCookies(k,mes,i);
            }
          }
          else//dia nao varia
          {
            getAllCookies(dia,mes,i);
          }
      }
    }
  }
  else//ano nao varia
  {
      if (mes =="0")//mes varia
      {
        for (var j = 1; j < 13; j++)
        {
          if (dia == "0")//dia varia
          {
            for (var k = 1; k < 32; k++)
            {
               getAllCookies(k,j,ano);
            }
          }
          else//dia nao varia
          {
            getAllCookies(dia,j,ano);
          }
        }
      }
      else //mes nao varia
      {
        if (dia == "0")//dia varia
          {
            for (var k = 1; k < 32; k++)
            {
               getAllCookies(k,mes,ano);
            }
          }
          else//dia nao varia
          {
            getAllCookies(dia,mes,ano);
          }
      }
  }
  if (cookiesIndice == 0)
    alert("Nenhum LOG encontrado");
  else
  {
    //preparar o TXT e mandar para download
  }
  cookiesIndice = 0;
}
function canvasDrawLine()
{
  ctx.fillStyle = "white";

  ctx.beginPath();
  ctx.strokeStyle = "white";
  ctx.lineWidth = 1;
  ctx.moveTo(c.width*0.37,c.height*0.37);
  ctx.lineTo(size_font_big*3,size_font_big*3);
  ctx.stroke();//< /\

  ctx.beginPath();
  ctx.strokeStyle = "white";
  ctx.lineWidth = 1;
  ctx.moveTo(c.width*0.36,c.height*0.5);
  ctx.lineTo(size_font_big*5,c.height*0.5);
  ctx.stroke();//<

  ctx.beginPath();
  ctx.strokeStyle = "white";
  ctx.lineWidth = 1;
  ctx.moveTo(c.width*0.38,c.height*0.62);
  ctx.lineTo(size_font_big*3,c.height-size_font_big*3);
  ctx.stroke();//< \/

  ctx.beginPath();
  ctx.strokeStyle = "white";
  ctx.lineWidth = 1;
  ctx.moveTo(c.width*0.5,c.height*0.67);
  ctx.lineTo(c.width*0.5,c.height-size_font_big*5);
  ctx.stroke();//\/

  ctx.beginPath();
  ctx.strokeStyle = "white";
  ctx.lineWidth = 1;
  ctx.moveTo(c.width*0.62,c.height*0.62);
  ctx.lineTo(c.width-size_font_big*3,c.height-size_font_big*3);
  ctx.stroke();//> \/

  ctx.beginPath();
  ctx.strokeStyle = "white";
  ctx.lineWidth = 1;
  ctx.moveTo(c.width*0.63,c.height*0.5);
  ctx.lineTo(c.width-size_font_big*5,c.height*0.5);
  ctx.stroke();//>

  ctx.beginPath();
  ctx.strokeStyle = "white";
  ctx.lineWidth = 1;
  ctx.moveTo(c.width*0.63,c.height*0.37);
  ctx.lineTo(c.width-size_font_big*3,size_font_big*3);
  ctx.stroke();//> /\

  ctx.beginPath();
  ctx.strokeStyle = "white";
  ctx.lineWidth = 1;
  ctx.moveTo(c.width*0.5,c.height*0.34);
  ctx.lineTo(c.width*0.5,size_font_big*5);
  ctx.stroke();// /\
}

function canvasDraw()
{
  // Desenhando linhas
  canvasDrawLine();
  // Desenhando letras em cada ponto da tela
  ctx.textAlign="start";
  canvasDrawTeclado(0,"A");
  canvasDrawTeclado(0,"E");
  canvasDrawTeclado(0,"H");
  canvasDrawTeclado(0,"F");
  canvasDrawTeclado(0,"G");
  canvasDrawTeclado(0,"D");
  canvasDrawTeclado(0,"C");
  canvasDrawTeclado(0,"B");
}

function keyboardTrans(pos) //Funcao para inverter teclado principal com secundario
{
      // Inverte teclado principal
      if(pos != "H" && pos != "G" && pos != "B") //tirar ultima condição para habilitar shift
      {
        // Inverte o valor do gatilho
        posicao[pos].teclado = !posicao[pos].teclado;
        //Trocando os valores de text da posicao desejada
        posicao[pos].text1A = posicao[pos].text2A + (posicao[pos].text2A = posicao[pos].text1A,'');
        posicao[pos].text1B = posicao[pos].text2B + (posicao[pos].text2B = posicao[pos].text1B,'');
        posicao[pos].text1C = posicao[pos].text2C + (posicao[pos].text2C = posicao[pos].text1C,'');
        // Toca o som ao inverter teclado
        document.getElementById('flip').play();
      }
      // Chama a funcao highlight
      highlight(posicao[pos].highlightW,posicao[pos].highlightH,0);
}

// Funcao para dar destaque ou remover do conjunto de letras
function highlight(x,y,limpar)
{
  if(status == 0)
    // Limpa tela
    ctx.clearRect ( 0 , 0 , c.width, c.height );

  // Limpa selecao
  if (limpar)
  {
    ctx.beginPath()
	  ctx.arc(x,y,c.width*0.1,0,2*Math.PI);
	  ctx.fillStyle = "black";
	  ctx.fill();
  }
  // Desenha selecao
  else
  {
    var grd = ctx.createRadialGradient(x,y,c.width*0.001,x,y,c.width*0.5);
    grd.addColorStop(0,"black");
    grd.addColorStop(1,"white");
    ctx.beginPath();
    ctx.arc(x,y,c.width*0.1,0,2*Math.PI);
    ctx.fillStyle = grd;
    ctx.fill();
  }
  if(status == 0)
    // Desenha o teclado novamente
    canvasDraw();
}

function canvasDrawTeclado(controle,pos)
{
  ctx.fillStyle = 'white';
  if(!controle)
  {
    //Teclado Primario
    if(pos == "B")
      ctx.font = size_font_big*2+"px "+posicao[pos].font1;
    else
      ctx.font = size_font_big+"px "+posicao[pos].font1;
    //Teclado Secundario
    if(pos == "B")
      ctx.font = size_font_small*2+"px "+posicao[pos].font2;
    else
      ctx.font = size_font_small+"px "+posicao[pos].font2;
    // MINIATURA Secundario
    ctx.fillStyle = "rgba(100, 100, 100, 100)";
    ctx.fillText(posicao[pos].text2A,posicao[pos].width1D,posicao[pos].height1D);
    ctx.fillText(posicao[pos].text2B,posicao[pos].width2D,posicao[pos].height2D);
    ctx.fillText(posicao[pos].text2C,posicao[pos].width3D,posicao[pos].height3D);
    // MINIATURA Primario
    if(pos != "B")
      ctx.font = "bold "+size_font_small+"px "+posicao[pos].font2;
    ctx.fillStyle = "white";
    ctx.fillText(posicao[pos].text1A,posicao[pos].width1C,posicao[pos].height1C);
    ctx.fillText(posicao[pos].text1B,posicao[pos].width2C,posicao[pos].height2C);
    ctx.fillText(posicao[pos].text1C,posicao[pos].width3C,posicao[pos].height3C);
  }
}

function drawChar(comb,pos)
{
  if(comb.substring(0,2) == ";")
  {
    ctx.font = size_font_big+"px sign"
    ctx.fillText("^",posicao[pos].width1A,posicao[pos].height1A);
  }
  else
    if(comb.substring(0,1) == "B")
    {
      ctx.font = size_font_big+"px betsy2"
      if(Letra(comb.substring(0,2),0) == " ")
        letra = "D";
      if(Letra(comb.substring(0,2),0) == "DEL")
        letra = "V";
      if(Letra(comb.substring(0,2),0) == ". ")
        letra = "A"

      if(letra == "D")
        ctx.fillText(letra,posicao[pos].width1A-size_font_small,posicao[pos].height1A);
      else
        ctx.fillText(letra,posicao[pos].width1A,posicao[pos].height1A);
    }
    else
    {
      if(comb == "CFDGB")
      {
        ctx.font = size_font_big*2+"px keys"
        ctx.fillText("L",posicao[pos].width1A-size_font_small,posicao[pos].height1A);
      }
      else
      {
        ctx.font = size_font_big+"px Arial"
        ctx.fillText(Letra(comb.substring(0,2),0),posicao[pos].width1A,posicao[pos].height1A);
      }
    }
}

function mOver(pos)
{
  if (pos == "centro") //se entrou no centro
  {
        var aux = 0;
      var comb = "";
      while (indice > aux)
      {
		if ((combination[0] == combination[aux]) && aux != 0)
		{
			comb = ';'
			break;
		}
        comb =  comb + combination[aux];
        aux++;
      }

	  document.getElementById("editor").style.backgroundColor = '#333333';
	  if (comb != "CFDGB")
		Letra(comb.substring(0,2),1);
	  else
		Letra(comb,1);
      if (status != 2) //se a tela estiver desbloqueada
      {
        // Volta o teclado para a posicao principal
        if(posicao[combination[0]].teclado != shiftaux && combination[0] != "B")
          keyboardTrans(combination[0]);
        if(shiftaux && posicao["B"].teclado == shiftaux)
          keyboardTrans("B");
      }
	  indice = 0;
      while(indice <= 7)
      {
        highlight(vetorDados[indice].highlightW,vetorDados[indice].highlightH,1);
        indice++;
      }
      indice = 0;
      pos = "N";
      comb = "";
  }
  else //se entrou em algum canto
  {
    if (indice == 0 && status != 2) //se é a primeira letra após sair do centro
    {
      highlight(posicao[pos].highlightW,posicao[pos].highlightH,0);
      timerId = setInterval(function(){keyboardTrans(pos);drawChar(comb,pos);},3000);
      // Caso a tela esteja desbloqueada tocar beep
      if(status == 0)
        document.getElementById('beep01').play();
      // Insere na comb
      combination[indice] = pos;
      indice++;
    }
    else
    {
      // Caso a tela esteja bloqueada , é possivel destacar 2 ou mais pontos na tela
	  if(status!=2)
      highlight(posicao[pos].highlightW,posicao[pos].highlightH,0);
      if(indice == 1 && combination[indice-1] == pos)
        timerId = setInterval(function(){keyboardTrans(pos);drawChar(comb,pos);},3000);
    }
    if (indice > 0 && combination[indice-1]!=pos)
    {
      combination[indice] = pos;
      indice++;
      if(status == 0)
        document.getElementById('beep02').play();
    }
	if(status == 0)
	{
	  var aux = 0;
      var comb = "";
      while (indice > aux)
      {
		if ((combination[0] == combination[aux]) && aux != 0)
		{
			comb = ';'
			break;
		}
        comb =  comb + combination[aux];
        aux++;
      }

    drawChar(comb,pos);
	}
  }
}

function mOut(pos)
{
  if (pos == "centro")//ao sair do centro
  {
    indice = 0;
	document.getElementById("editor").style.backgroundColor = 'transparent';
  }
  else//ao sair de qualquer canto
  {
    if (indice == 1)
      clearInterval(timerId);
	  document.getElementById(pos).innerHTML = '';
  }

}
// Funcao para encontrar o caracter desejado a partir da combinaçao entrada
function Letra(pos,flag)
{
    var caractere = ';';
    var length = editor.getLength();

    if(pos == "A")
		if (!posicao[pos].teclado)
			caractere = 'a';
		else
			caractere = '0';
    if(pos == "AC")
		if (!posicao["A"].teclado)
			caractere = 'b';
		else
			caractere = 'z';
    if(pos == "AE")
		if (!posicao["A"].teclado)
			caractere = 'c';
		else
			caractere = 'y';

    if(pos == "EA")
		if (!posicao["E"].teclado)
			caractere = 't';
		else
			caractere = 'k';
    if(pos == "E")
		if (!posicao[pos].teclado)
			caractere = 'u';
		else
			caractere = 'w';
    if(pos == "EH")
		if (!posicao["E"].teclado)
			caractere = 'v';
		else
			caractere = 'x';

    if(pos == "HE")
		//if (!posicao["H"].teclado)
			caractere = 'q';
		//else
			//editor.insertText(length-1, '4',{'color': cores[coresCont],'size':'30px'});
    if(pos == "H")
		//if (!posicao[pos].teclado)
			caractere = 's';
		//else
			//editor.insertText(length-1, '5',{'color': cores[coresCont],'size':'30px'});
    if(pos == "HB")
		//if(!posicao["H"].teclado)
			caractere = 'r';
		//else
			//editor.insertText(length-1, '6',{'color': cores[coresCont],'size':'30px'});

    if(pos == "FC")
		if(!posicao["F"].teclado)
			caractere = 'g';
		else
			caractere = '4';
    if(pos == "F")
		if (!posicao[pos].teclado)
			caractere = 'i';
		else
			caractere = '5';
    if(pos == "FD")
		if (!posicao["F"].teclado)
			caractere = 'h';
		else
			caractere = '6';
    if(pos == "DF")
		if (!posicao["D"].teclado)
			caractere = 'j';
		else
			caractere = '7';
    if(pos == "D")
       if (!posicao[pos].teclado)
			caractere = 'l';
		else
			caractere = '8';
    if(pos == "DG")
       if (!posicao["D"].teclado)
			caractere = 'm';
		else
			caractere = '9';
    if(pos == "GD")
       caractere = 'n';
    if(pos == "GB")
       caractere = 'p';
    if(pos == "G")
       caractere = 'o';
    if(pos == "CA")
		if (!posicao["C"].teclado)
			caractere = 'd';
		else
			caractere = '1';
    if(pos == "C")
		if (!posicao[pos].teclado)
			caractere = 'e';
	    else
			caractere = '2';
    if(pos == "CF")
		if (!posicao["C"].teclado)
			caractere = 'f';
		else
			caractere = '3';
	  if(pos == "B")
       if(!posicao["B"].teclado)
          caractere = ' ';
       //else
          //shiftAll(); VOLTAR ISSO PARA USAR O SHIFT

    if(pos == "BG")
      if(!posicao["B"].teclado)
        caractere = ". ";

   if(caractere!=';' && flag)
    {
       if(status == 0)
       {
         // Verifica se a letra a ser inserida a seguir é maiuscula
         if (texto.substring(texto.length-2,texto.length) == ". " || texto[texto.length-1] == '.' || texto == "")
         // Letra maiuscula
            caractere = caractere.toUpperCase();
         // Insere letra no editor
         editor.insertText(length-1,caractere,{'color': cores[coresCont],'size':'30px'});
         texto = texto.concat(caractere);
         // Manter sempre a caixa de texto atualizada ( auto scroll )
         objeto = document.getElementById('editor');
         objeto.scrollTop = objeto.scrollHeight;
         // Posicionando cursor
         if(length == 0)
           length++;
         // Mudando cor do texto
         if(caractere == ". ")
         {
            if(coresCont == 0)
              coresCont = 1;
            else
              coresCont = 0;
            length++;
         }
         document.getElementById('beep03').play();
       }
       editor.setSelection(length,length);
    }
    if(pos == "BH")
    {
	   caractere = 'del';
       if(!posicao["B"].teclado && flag)
          if(status == 0)
          {
            document.getElementById('beep03').play();
            if(length > 0)
            {
              var lastChar = editor.getText(length-2,length-1);
              // Verifica se um ponto foi removido e muda a cor no caso positivo
              if(lastChar == '.')
         	      if(coresCont == 0)
         	   		   coresCont = 1;
         	   	  else
         	   		   coresCont = 0;
              editor.deleteText(length-2,length);
              texto = texto.substring(0,texto.length-1);
              editor.setSelection(length-1,length-1);
            }
          }
    }

	if(!flag)
		return caractere.toUpperCase();

    // Combinacao para bloquei de tela
    if(pos == "CFDGB" && flag)
    {
      document.getElementById('lock').play();
      if(status == 0)
        // Bloqueia
        ocioso(0);
      else
        // Desbloqueia
        ocioso(2)
    }
}
function cursor()
{
	if (cursorVisivel)
	{
		document.body.style.cursor = 'none';
		document.getElementById('editor').style.cursor = 'none';
    document.getElementById('A').style.background = 'none'
    document.getElementById('C').style.background = 'none'
    document.getElementById('F').style.background = 'none'
    document.getElementById('D').style.background = 'none'
    document.getElementById('G').style.background = 'none'
    document.getElementById('B').style.background = 'none'
    document.getElementById('H').style.background = 'none'
    document.getElementById('E').style.background = 'none'
  }
	else
	{
		document.body.style.cursor = 'default';
		document.getElementById('editor').style.cursor = 'default';
    document.getElementById('A').style.background = 'gray'
    document.getElementById('C').style.background = 'yellow'
    document.getElementById('F').style.background = 'blue'
    document.getElementById('D').style.background = 'green'
    document.getElementById('G').style.background = 'red'
    document.getElementById('B').style.background = 'white'
    document.getElementById('H').style.background = 'brown'
    document.getElementById('E').style.background = 'purple'
	}
	cursorVisivel = !cursorVisivel;
}

</script>
<style>
body {position:fixed;width:100%; height:100%; overflow:hidden, margin:0}
html {width:100%; height:100%; overflow:hidden}
@font-face {
   font-family: "betsy2";
    /* IE */
    src: url('./data/fonts/BETSY2.eot');
    /* IE */

    /* Not IE */
    src: local("betsy2ttf"), url('./data/fonts/BETSY2.ttf');
    format("truetype");
    /* Not IE */
}
@font-face {
    font-family: "sign";
     /* IE */
     src: url('./data/fonts/SIGN.eot');
     /* IE */

     /* Not IE */
     src: local("signttf"), url('./data/fonts/SIGN.ttf');
     format("truetype");
     /* Not IE */
}
@font-face {
    font-family: "keys";
     /* IE */
     src: url('./data/fonts/KEYS.eot');
     /* IE */

     /* Not IE */
     src: local("keysttf"), url('./data/fonts/KEYS.ttf');
     format("truetype");
     /* Not IE */
}
</style>
</head>
<body  style="margin:0px" onLoad="inicio()" onclick="cursor()">
  <div id="spinnerDiv" style="width:100%;height:100%;border:1px solid" >
  <div id="A" style="background-color:transparent;position: absolute; left:0%;top:0%; width:35%; height:35%" onmouseover="mOver(this.getAttribute('id'))" onmouseout="mOut(this.getAttribute('id'))"></div>
  <div id="C" style="background-color:transparent;position: absolute; left:35%;top:0%; width:30%; height:20%" onmouseover="mOver(this.getAttribute('id'))" onmouseout="mOut(this.getAttribute('id'))"></div>
  <div id="F" style="background-color:transparent;position: absolute; left:65%;top:0%; width:35%; height:35%" onmouseover="mOver(this.getAttribute('id'))" onmouseout="mOut(this.getAttribute('id'))"></div>
  <div id="D" style="background-color:transparent;position: absolute; left:80%;top:35%; width:20%; height:30%" onmouseover="mOver(this.getAttribute('id'))" onmouseout="mOut(this.getAttribute('id'))"></div>
  <div id="G" style="background-color:transparent;position: absolute; left:65%;top:65%; width:35%; height:35%" onmouseover="mOver(this.getAttribute('id'))" onmouseout="mOut(this.getAttribute('id'))"></div>
  <div id="B" style="background-color:transparent;position: absolute; left:35%;top:80%; width:30%; height:20%" onmouseover="mOver(this.getAttribute('id'))" onmouseout="mOut(this.getAttribute('id'))"></div>
  <div id="H" style="background-color:transparent;position: absolute; left:0%;top:65%; width:35%; height:35%" onmouseover="mOver(this.getAttribute('id'))" onmouseout="mOut(this.getAttribute('id'))"></div>
  <div id="E" style="background-color:transparent;position: absolute; left:0%;top:35%; width:20%; height:30%" onmouseover="mOver(this.getAttribute('id'))" onmouseout="mOut(this.getAttribute('id'))"></div>
  <div id="centro" style="position: absolute; left:40%;top:40%; width:20%; height: 20%" onmouseover="mOver(this.getAttribute('id'))" onmouseout="mOut(this.getAttribute('id'))">
	<div id="editor" style="position: absolute;width:100%; height: 100%"></div></div>
  <canvas id="myCanvas" style="border:1px; background-color:black"></canvas>

</body>
</html>
